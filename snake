import pygame
import random
import sys

pygame.init()

# Экран параметрлері
WIDTH, HEIGHT = 600, 600
CELL_SIZE = 20
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("Snake Game")
clock = pygame.time.Clock()

# Түстер
WHITE = (255, 255, 255)
GREEN = (0, 255, 0)
DARK_GREEN = (0, 200, 0)
DARKER_GREEN = (0, 150, 0)
RED = (255, 0, 0)

# Жылдамдық
snake_speed = 10

# Жылан басталу координатасы
snake = [(300, 300)]
direction = (CELL_SIZE, 0)

# Тамақтар
foods = []
food_timers = {}
food_colors = [GREEN, DARK_GREEN, DARKER_GREEN]


# Тамақ жасау функциясы
def generate_food():
    x = random.randint(0, (WIDTH // CELL_SIZE) - 1) * CELL_SIZE
    y = random.randint(0, (HEIGHT // CELL_SIZE) - 1) * CELL_SIZE
    color = random.choice(food_colors)
    has_timer = random.choice([True, False])

    food = (x, y, color)
    foods.append(food)
    if has_timer:
        food_timers[food] = pygame.time.get_ticks() + 3000  # 3 секунд


# Жылан қозғалысын жаңарту
def move_snake():
    global snake
    head_x, head_y = snake[0]
    new_head = (head_x + direction[0], head_y + direction[1])

    # Қабырғадан өтсе, қарама-қарсы жақтан шығу
    if new_head[0] < 0:
        new_head = (WIDTH - CELL_SIZE, new_head[1])
    elif new_head[0] >= WIDTH:
        new_head = (0, new_head[1])
    elif new_head[1] < 0:
        new_head = (new_head[0], HEIGHT - CELL_SIZE)
    elif new_head[1] >= HEIGHT:
        new_head = (new_head[0], 0)

    snake.insert(0, new_head)

    for food in foods:
        if new_head[0] == food[0] and new_head[1] == food[1]:
            foods.remove(food)
            food_timers.pop(food, None)
            return

    snake.pop()


# Ойынды жүргізу
running = True
while running:
    screen.fill(WHITE)

    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
        elif event.type == pygame.KEYDOWN:
            if event.key == pygame.K_UP and direction != (0, CELL_SIZE):
                direction = (0, -CELL_SIZE)
            elif event.key == pygame.K_DOWN and direction != (0, -CELL_SIZE):
                direction = (0, CELL_SIZE)
            elif event.key == pygame.K_LEFT and direction != (CELL_SIZE, 0):
                direction = (-CELL_SIZE, 0)
            elif event.key == pygame.K_RIGHT and direction != (-CELL_SIZE, 0):
                direction = (CELL_SIZE, 0)

    move_snake()

    # Тамақ жасау
    if random.random() < 0.03:
        generate_food()

    # Тамақтарды салу
    current_time = pygame.time.get_ticks()
    for food in foods[:]:
        pygame.draw.rect(screen, food[2], (food[0], food[1], CELL_SIZE, CELL_SIZE))

        if food in food_timers and current_time > food_timers[food]:
            foods.remove(food)
            del food_timers[food]

    # Жыланды салу
    for segment in snake:
        pygame.draw.rect(screen, GREEN, (segment[0], segment[1], CELL_SIZE, CELL_SIZE))

    pygame.display.update()
    clock.tick(snake_speed)

pygame.quit()
sys.exit()
